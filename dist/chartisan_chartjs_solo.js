!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("chart.js")):"function"==typeof define&&define.amd?define(["exports","chart.js"],n):n((t=t||self)["@chartisan/chartjs"]={},t.Chart)}(this,(function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function o(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}var r=function(){return(r=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return"chart"in t&&"datasets"in t&&function(t){return"labels"in t&&"extra"in t}(t.chart)&&t.datasets.every((function(t){return function(t){return"id"in t&&"name"in t&&"values"in t&&"extra"in t}(t)}))}!function(t,n){void 0===n&&(n={});var e=n.insertAt;if("undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===e&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}(".chartisan-controller,\n.chartisan-body {\n    position: relative;\n    height: 100%;\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.chartisan-modal {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    justify-content: center;\n    align-items: center;\n}\n.chartisan-help-block {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n}\n.chartisan-help-text {\n    margin-top: 1.5rem;\n    text-transform: uppercase;\n    letter-spacing: 0.2em;\n    font-size: 0.75rem;\n}\n.chartisan-help-text-error {\n    margin-top: 1.5rem;\n    text-transform: uppercase;\n    letter-spacing: 0.2em;\n    font-size: 0.6rem;\n    color: #f56565;\n}\n.chartisan-refresh-chart {\n    cursor: pointer;\n}\n");var s=function(t){return function(t){return!!t&&"object"==i(t)}(t)&&!function(t){var n=Object.prototype.toString.call(t);return"[object RegExp]"===n||"[object Date]"===n||function(t){return t.$$typeof===c}(t)}(t)},c="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function l(t,n){return!1!==n.clone&&n.isMergeableObject(t)?f((e=t,Array.isArray(e)?[]:{}),t,n):t;var e}function u(t,n,e){return t.concat(n).map((function(t){return l(t,e)}))}function h(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(n){return t.propertyIsEnumerable(n)})):[]}(t))}function d(t,n){try{return n in t}catch(t){return!1}}function p(t,n,e){var o={};return e.isMergeableObject(t)&&h(t).forEach((function(n){o[n]=l(t[n],e)})),h(n).forEach((function(r){(function(t,n){return d(t,n)&&!(Object.hasOwnProperty.call(t,n)&&Object.propertyIsEnumerable.call(t,n))})(t,r)||(d(t,r)&&e.isMergeableObject(n[r])?o[r]=function(t,n){if(!n.customMerge)return f;var e=n.customMerge(t);return"function"==typeof e?e:f}(r,e)(t[r],n[r],e):o[r]=l(n[r],e))})),o}function f(t,n,e){(e=e||{}).arrayMerge=e.arrayMerge||u,e.isMergeableObject=e.isMergeableObject||s,e.cloneUnlessOtherwiseSpecified=l;var o=Array.isArray(n);return o===Array.isArray(t)?o?e.arrayMerge(t,n,e):p(t,n,e):l(n,e)}f.all=function(t,n){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,e){return f(t,e,n)}),{})};var y,v=["#667EEA","#F56565","#48BB78","#ED8936","#9F7AEA","#38B2AC","#ECC94B","#4299E1","#ED64A6"],g=f,m=function(){return(m=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},b={general:function(t){var n=t.size,e=t.color;return'\n    <svg\n        role="img"\n        xmlns="http://www.w3.org/2000/svg"\n        width="'+n[0]+'"\n        height="'+n[1]+'"\n        viewBox="0 0 24 24"\n        aria-labelledby="refreshIconTitle"\n        stroke="'+e+'"\n        stroke-width="1"\n        stroke-linecap="square"\n        stroke-linejoin="miter"\n        fill="none"\n        color="'+e+'"\n    >\n        <title id="refreshIconTitle">Refresh</title>\n        <polyline points="22 12 19 15 16 12"/>\n        <path d="M11,20 C6.581722,20 3,16.418278 3,12 C3,7.581722 6.581722,4 11,4 C15.418278,4 19,7.581722 19,12 L19,14"/>\n    </svg>\n'}},w=function(t,n){return'\n    <div class="chartisan-help-block">\n    <div class="chartisan-refresh-chart">\n        '+b[t.type](t)+"\n    </div>\n    "+(""==t.text?"":'\n                <div class="chartisan-help-text" style="color: '+t.textColor+';">\n                    '+t.text+"\n                </div>\n            ")+"\n    "+(t.debug?'<div class="chartisan-help-text-error">\n        '+n.message+"\n    </div>":"")+"\n    </div>\n"},x={bar:function(t){var n=t.size,e=t.color;return'\n    <svg width="'+n[0]+'" height="'+n[1]+'" viewBox="0 0 135 140" xmlns="http://www.w3.org/2000/svg" fill="'+e+'">\n        <rect y="10" width="15" height="120" rx="6">\n            <animate attributeName="height"\n                begin="0.5s" dur="1s"\n                values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"\n                repeatCount="indefinite" />\n            <animate attributeName="y"\n                begin="0.5s" dur="1s"\n                values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"\n                repeatCount="indefinite" />\n        </rect>\n        <rect x="30" y="10" width="15" height="120" rx="6">\n            <animate attributeName="height"\n                begin="0.25s" dur="1s"\n                values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"\n                repeatCount="indefinite" />\n            <animate attributeName="y"\n                begin="0.25s" dur="1s"\n                values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"\n                repeatCount="indefinite" />\n        </rect>\n        <rect x="60" width="15" height="140" rx="6">\n            <animate attributeName="height"\n                begin="0s" dur="1s"\n                values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"\n                repeatCount="indefinite" />\n            <animate attributeName="y"\n                begin="0s" dur="1s"\n                values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"\n                repeatCount="indefinite" />\n        </rect>\n        <rect x="90" y="10" width="15" height="120" rx="6">\n            <animate attributeName="height"\n                begin="0.25s" dur="1s"\n                values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"\n                repeatCount="indefinite" />\n            <animate attributeName="y"\n                begin="0.25s" dur="1s"\n                values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"\n                repeatCount="indefinite" />\n        </rect>\n        <rect x="120" y="10" width="15" height="120" rx="6">\n            <animate attributeName="height"\n                begin="0.5s" dur="1s"\n                values="120;110;100;90;80;70;60;50;40;140;120" calcMode="linear"\n                repeatCount="indefinite" />\n            <animate attributeName="y"\n                begin="0.5s" dur="1s"\n                values="10;15;20;25;30;35;40;45;50;0;10" calcMode="linear"\n                repeatCount="indefinite" />\n        </rect>\n    </svg>\n'}},C=function(t){return'\n    <div class="chartisan-help-block">\n        '+x[t.type](t)+"\n        "+(""==t.text?"":'\n                    <div class="chartisan-help-text" style="color: '+t.textColor+';">\n                        '+t.text+"\n                    </div>\n                ")+"\n    </div>\n"};!function(t){t.Initializing="initializing",t.Loading="loading",t.Error="error",t.Show="show"}(y||(y={}));var k=function(){function t(t){this.options={el:".chart",url:void 0,options:void 0,data:void 0,loader:{type:"bar",size:[35,35],color:"#000",text:"Loading chart",textColor:"#a0aec0"},error:{type:"general",size:[50,50],color:"#f56565",text:"There was an error",textColor:"#a0aec0",debug:!0},hooks:void 0},this.cstate=y.Initializing;var n=(this.options=m(m({},this.options),t)).el,e=document.querySelector(n);if(!e)throw Error("[Chartisan] Unable to find an element to bind the chart to a DOM element with the selector = '"+n+"'");this.element=e,this.controller=document.createElement("div"),this.body=document.createElement("div"),this.modal=document.createElement("div"),this.bootstrap()}return t.prototype.setModal=function(t){var n=t.show,e=void 0===n||n,o=t.color,r=void 0===o?"#FFFFFF":o,i=t.content;this.modal.style.backgroundColor=r,this.modal.style.display=e?"flex":"none",i&&(this.modal.innerHTML=i)},t.prototype.changeTo=function(t,n){t===(y.Initializing,y.Loading)?this.setModal({show:!0,content:C(this.options.loader)}):t===y.Show?this.setModal({show:!1}):t===y.Error&&(this.setModal({show:!0,content:w(this.options.error,null==n?new Error("Unknown Error"):n)}),this.refreshEvent()),this.cstate=t},t.prototype.bootstrap=function(){this.element.appendChild(this.controller),this.controller.appendChild(this.body),this.controller.appendChild(this.modal),this.controller.classList.add("chartisan-controller"),this.body.classList.add("chartisan-body"),this.modal.classList.add("chartisan-modal"),this.update(this.options)},t.prototype.request=function(t){var n=this;this.options.url||this.onError(new Error("[Chartisan] No URL provided to fetch the data.")),fetch(this.options.url,this.options.options).then((function(t){return t.json()})).then((function(e){return n.onRawUpdate(e,t)})).catch((function(t){return n.onError(t)}))},t.prototype.refreshEvent=function(){var t=this;this.controller.getElementsByClassName("chartisan-refresh-chart")[0].addEventListener("click",(function(){return t.update()}),{once:!0})},t.prototype.update=function(t){var n,e,o,r,i,s,c;if((null===(n=t)||void 0===n?void 0:n.url)&&(this.options.url=t.url),(null===(e=t)||void 0===e?void 0:e.options)&&(this.options.options=t.options),null===(o=t)||void 0===o?void 0:o.data){var l=void 0;a(t.data)?l=t.data:((null===(r=t)||void 0===r?void 0:r.background)||this.changeTo(y.Loading),l=t.data());var u=this.getDataFrom(l);return this.changeTo(y.Show),t.background?this.onBackgroundUpdate(u,null===(i=t)||void 0===i?void 0:i.additional):this.onUpdate(u,null===(s=t)||void 0===s?void 0:s.additional)}(null===(c=t)||void 0===c?void 0:c.background)||this.changeTo(y.Loading),this.request(t)},t.prototype.getDataFrom=function(t){var n=this.formatData(t);if(this.options.hooks)for(var e=0,o=this.options.hooks.hooks;e<o.length;e++)n=(0,o[e])(n);return n},t.prototype.onRawUpdate=function(t,n){var e,o,r;if(!a(t))return this.onError(new Error("Invalid server data"));var i=this.getDataFrom(t);this.changeTo(y.Show),(null===(e=n)||void 0===e?void 0:e.background)?this.onBackgroundUpdate(i,null===(o=n)||void 0===o?void 0:o.additional):this.onUpdate(i,null===(r=n)||void 0===r?void 0:r.additional)},t.prototype.onError=function(t){this.changeTo(y.Error,t)},t.prototype.state=function(){return this.cstate},t}(),E=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.colors=function(t){return void 0===t&&(t=v),this.hooks.push((function(n){var e;return(null===(e=n.data)||void 0===e?void 0:e.datasets)&&(n.data.datasets=n.data.datasets.map((function(n,e){return r(r({},n),{borderColor:t[e%t.length],backgroundColor:t[e%t.length]})}))),n})),this},n.prototype.responsive=function(t){return void 0===t&&(t=!0),this.hooks.push((function(n){return g(n,{options:{maintainAspectRatio:!t}})})),this},n.prototype.legend=function(t){return void 0===t&&(t={}),"boolean"==typeof t&&(t={display:t}),this.hooks.push((function(n){return g(n,{options:{legend:t}})})),this},n.prototype.displayAxes=function(t,n){return void 0===t&&(t=!0),void 0===n&&(n=!1),this.hooks.push((function(e){return g(e,n?{options:{scale:{display:t}}}:{options:{scales:{xAxes:[{display:t}],yAxes:[{display:t}]}}})})),this},n.prototype.minimalist=function(t){return void 0===t&&(t=!0),this.legend({display:!t}),this.displayAxes(!t),this},n.prototype.padding=function(t){return void 0===t&&(t=5),this.hooks.push((function(n){return g(n,{options:{layout:{padding:t}}})})),this},n.prototype.datasets=function(t,n){return void 0===n&&(n="bar"),this.hooks.push((function(e){var o;if(e.type="string"==typeof t?t:n,Array.isArray(t)&&(null===(o=e.data)||void 0===o?void 0:o.datasets)){var i=t.map((function(t){return"string"==typeof t?{type:t}:t}));e.data.datasets=e.data.datasets.map((function(t,n){return r(r({},t),i[n%i.length])}))}return e})),this},n.prototype.title=function(t){return void 0===t&&(t={}),t="string"==typeof t?{text:t,display:!0}:r({display:!0},t),this.hooks.push((function(n){return g(n,{options:{title:t}})})),this},n.prototype.beginAtZero=function(t){return void 0===t&&(t=!0),this.hooks.push((function(n){return g(n,{options:{scales:{yAxes:[{ticks:{beginAtZero:t}}]}}})})),this},n.prototype.tooltip=function(t){return"boolean"==typeof t&&(t={enabled:t}),this.hooks.push((function(n){return g(n,{options:{tooltips:t}})})),this},n.prototype.legendCallback=function(t){return this.hooks.push((function(n){return g(n,{options:{legendCallback:t}})})),this},n.prototype.animation=function(t){return this.hooks.push((function(n){return g(n,{options:{animation:t}})})),this},n}((function(){this.hooks=[]})),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.mutateArray=function(t,n,e){var o;for(o=0;o<n.length;o++)if(o<t.length){if(e){e(t,n,o);continue}t[o]=n[o]}else t.push(n[o]);for(;o<t.length;)t.pop()},e.prototype.formatData=function(t){return{type:"bar",data:{labels:t.chart.labels,datasets:t.datasets.map((function(t){return{label:t.name,data:t.values}}))},options:{}}},e.prototype.renewCanvas=function(){this.canvas&&this.body.removeChild(this.canvas),this.canvas=document.createElement("canvas"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.body.appendChild(this.canvas)},e.prototype.onUpdate=function(t){this.chart&&this.chart.destroy(),this.renewCanvas(),this.chart=new n(this.canvas,t)},e.prototype.onBackgroundUpdate=function(t,n){var o,i;this.chart&&(this.chart.options=r(r({},this.chart.options),t.options),this.chart.data.labels&&(null===(o=t.data)||void 0===o?void 0:o.labels)&&e.mutateArray(this.chart.data.labels,t.data.labels),this.chart.data.datasets&&(null===(i=t.data)||void 0===i?void 0:i.datasets)&&e.mutateArray(this.chart.data.datasets,t.data.datasets,(function(t,n,o){e.mutateArray(t[o].data,n[o].data)})),this.chart.update(n))},e.prototype.toImage=function(){var t;return null===(t=this.chart)||void 0===t?void 0:t.toBase64Image()},e.prototype.legend=function(){var t,n;return null!=(n=null===(t=this.chart)||void 0===t?void 0:t.generateLegend())?n:void 0},e}(k);window.Chartisan=j,window.ChartisanHooks=E,t.Chartisan=j,t.ChartisanHooks=E,Object.defineProperty(t,"__esModule",{value:!0})}));
